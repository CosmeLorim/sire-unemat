<script>
    $('#atualizarPeriodo').on('click', function () {
        var periodoNovo = new Periodo();

        if (!periodoNovo.validaNome($('#nome').val()))
            return;
        periodoNovo.nome = $('#nome').val();

        var data_inicio = parseInt(moment($("#data").data('daterangepicker').startDate).format('X'));
        var data_fim = parseInt(moment($("#data").data('daterangepicker').endDate).format('X'));

        periodoNovo.ativo = $('#ativo').prop('checked');

        var admin = new Admin();
        var titulo = 'Cadastro de período';
        var conteudo = 'Deseja período \"' + periodoNovo.nome + '\"?';

        var callback = function ()
        {
            $.ajax({
                url: '/api/periodo/' + periodoAntigo.id,
                type: 'put',
                data: 
                    {
                        nome: periodoNovo.nome,
                        ativo: periodoNovo.ativo,
                        dataInicio: 
                        {
                            dia: moment($("#data").data('daterangepicker').startDate).format('DD'),
                            mes: moment($("#data").data('daterangepicker').startDate).format('MM'),
                            ano: moment($("#data").data('daterangepicker').startDate).format('YYYY')
                        },
                        dataFim: 
                        {
                            dia: moment($("#data").data('daterangepicker').endDate).format('DD'),
                            mes: moment($("#data").data('daterangepicker').endDate).format('MM'),
                            ano: moment($("#data").data('daterangepicker').endDate).format('YYYY')
                        }
                    },
                success: function (data, status) {
                    $.Notify({
                        caption: data.title,
                        content: data.msg,
                        timeout: 10000,
                        type: data.status
                    });
                    if (data.status === 'success')
                    {
                        atualizaGridPeriodos();
                        limpaTelaPeriodos();
                    }
                }
            });
        };
        
        admin.dialog(titulo, conteudo, callback);
    });
</script>